language: pythonz
matrix:
  include:
  - os: linux
    sudo: false
    dist: trusty
    python: '2.7'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.4'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.5'
  - os: osx
    language: generic
    env: TRAVIS_PYTHON_VERSION=3.5
before_install:
- wget https://raw.githubusercontent.com/Horta/travis-miniconda/master/install.sh
  -O install.sh
- chmod +x install.sh
- travis_retry bash -x ./install.sh
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
before_script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py test
script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py sdist
- pip install dist/`ls dist | grep -i -E '\.(gz)$' | head -1`
- pushd /
- python -c "import numpy_sugar; numpy_sugar.test()"
- popd
branches:
  only:
  - master
notifications:
  email: false
deploy:
  provider: pypi
  skip_upload_docs: true
  user: dhorta
  password:
    secure: KCRgtpEGHYy7MDU+rWL9F1TroiMh+pdmNt5hFbIu/F0/6IdUlLosgJR35i5jCgsYtCCfwAvP5RrBc0yaCFeH8f85q0m5jMmfq6vzGqbtwtvNgD4QaWFnPhsmOW9kX+iD/6/W0LSLhg+j3DaszWYdf8hGv0R6ekgVh8E8MhjtwaMFbrsWrsXaio1MJf4VNOsUSZGm0SsJPiopHxPNMOy/sDm0+b17iRGv3cTYeGFIEnrBromhT57ahbsEFU2FGi0nyNlas4unjUBVis+7+bHdYbhPxTe6IqY44Cq/V+57n6PDh4SD+TYJ/F7N/MwW7Sf2464K731swkLc9pPYDasqwhqvXkXzwvazN+wIlkO1VUsQUAryjCFI+nVA8rz12T8/9EnRNOTDmuLga/E+34Dj8kCaCK0cEqqUnl5nRj3JcoUPa/8u9rZhizkwD6EPEmWFYH7KMwpnGN5O3RGc7+EpPKJF/IDFlgdmCXX023JF/AkvXIlBKlzqsRR8u1zilPBvbnd+XLLVuZohVOQ7We+2xIZGO/V/QY8YxfoeR21MF/nqUKTEWWED1VGtVnXba12WDeuWBwAAWWpYM46/B/aa9yM88Yo2HrSUnxSFdeGJHF8xmwsWUXEMlq5RxZqRUflWDG/smwDqXD3xACo/L5P/pI+IYU18eS50fUVyBTcuCks=
  on:
    distributions: sdist bdist_wheel
    repo: glimix/numpy-sugar
